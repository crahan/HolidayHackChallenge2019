<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Thomas Bouve">
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Open the Sleigh Shop Door - CraHan's KringleCon 2 Write-Up</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/gruvbox-light.min.css">
        <link href="../../css/extra.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/css.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/powershell.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bash.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">CraHan's KringleCon 2 Write-Up</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../..">Home</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Challenges <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../c1/">Talk to Santa & Find the Turtle Doves</a>
</li>
                                    
<li >
    <a href="../c2/">Unredact Threatening Document</a>
</li>
                                    
<li >
    <a href="../c3/">Evaluate Attack Outcome</a>
</li>
                                    
<li >
    <a href="../c4/">Determine Attacker Technique</a>
</li>
                                    
<li >
    <a href="../c5/">Determine Compromised System</a>
</li>
                                    
<li >
    <a href="../c6/">Splunk</a>
</li>
                                    
<li >
    <a href="../c7/">Get Access to the Steam Tunnels</a>
</li>
                                    
<li >
    <a href="../c8/">Bypassing the Frido Sleigh CAPTEHA</a>
</li>
                                    
<li >
    <a href="../c9/">Retrieve the Scraps of Paper from Server</a>
</li>
                                    
<li >
    <a href="../c10/">Recover Cleartext Document</a>
</li>
                                    
<li class="active">
    <a href="./">Open the Sleigh Shop Door</a>
</li>
                                    
<li >
    <a href="../c12/">Filter Out Poisoned Data Sources</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Hints <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../hints/h3/">Bushy Evergreen - Escape Ed</a>
</li>
                                    
<li >
    <a href="../../hints/h4/">SugarPlum Mary - Linux Path</a>
</li>
                                    
<li >
    <a href="../../hints/h5/">Sparkle Redberry - Xmas Cheer Laser</a>
</li>
                                    
<li >
    <a href="../../hints/h6/">Tangle Coalbox - Frosty Keypad</a>
</li>
                                    
<li >
    <a href="../../hints/h7/">Minty Candycane - Holiday Hack Trail</a>
</li>
                                    
<li >
    <a href="../../hints/h8/">Alabaster Snowball - Nyanshell</a>
</li>
                                    
<li >
    <a href="../../hints/h9/">Pepper Minstix - Graylog</a>
</li>
                                    
<li >
    <a href="../../hints/h10/">Holly Evergreen - Mongo Pilfer</a>
</li>
                                    
<li >
    <a href="../../hints/h11/">Kent Tinseltooth - Smart Braces</a>
</li>
                                    
<li >
    <a href="../../hints/h12/">Wunorse Openslae - Zeek JSON Analysis</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Scripts <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../scripts/find_code.py/">find_code.py</a>
</li>
                                    
<li >
    <a href="../../scripts/capteha_api.py/">capteha_api.py</a>
</li>
                                    
<li >
    <a href="../../scripts/token_proxy.py/">token_proxy.py</a>
</li>
                                    
<li >
    <a href="../../scripts/decrypt_pdf.py/">decrypt_pdf.py</a>
</li>
                                    
<li >
    <a href="../../scripts/match_user_agents.py/">match_user_agents.py</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Misc <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../misc/interesting_ui/">Interesting UI Elements</a>
</li>
                                    
<li >
    <a href="../../misc/progress_tokens/">Progress Tokens</a>
</li>
                                    
<li >
    <a href="../../misc/user_accounts/">User Accounts</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../c10/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../c12/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#open-the-sleigh-shop-door">Open the Sleigh Shop Door</a></li>
            <li><a href="#request">Request</a></li>
            <li><a href="#video">Video</a></li>
            <li><a href="#resources">Resources</a></li>
            <li><a href="#solution">Solution</a></li>
            <li><a href="#answer">Answer</a></li>
            <li><a href="#hint">Hint</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="open-the-sleigh-shop-door">Open the Sleigh Shop Door<a class="headerlink" href="#open-the-sleigh-shop-door" title="Permanent link">#</a></h1>
<p><strong>Hint</strong>: <a href="../../hints/h11/">Kent Tinseltooth - Smart Braces</a></p>
<h2 id="request">Request<a class="headerlink" href="#request" title="Permanent link">#</a></h2>
<blockquote>
<p>Psst - hey!<br />
I'm Shinny Upatree, and I know what's going on!<br />
Yeah, that's right - guarding the sleigh shop has made me privvy to some serious, high-level intel.<br />
In fact, I know WHO is causing all the trouble.<br />
Cindy? Oh no no, not that who. And stop guessing - you'll never figure it out.<br />
The only way you could would be if you could break into <a href="https://crate.elfu.org/">my crate</a>, here.<br />
You see, I've written the villain's name down on a piece of paper and hidden it away securely!</p>
</blockquote>
<h2 id="video">Video<a class="headerlink" href="#video" title="Permanent link">#</a></h2>
<p><div class="video-wrapper">
<iframe width="560" height="315" src="https://www.youtube.com/embed/0hpKaJUhUMg?start=158" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div></p>
<h2 id="resources">Resources<a class="headerlink" href="#resources" title="Permanent link">#</a></h2>
<ul>
<li><a href="https://crate.elfu.org/">Crate</a></li>
<li><a href="https://developers.google.com/web/tools/chrome-devtools">Chrome Developer Tools</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Tools">Firefox Developer Tools</a></li>
<li><a href="https://developer.apple.com/safari/tools/">Safari Developer Tools</a></li>
<li><a href="https://docs.microsoft.com/en-us/microsoft-edge/devtools-guide/console">Edge Developer Tools</a></li>
<li><a href="https://curl.haxx.se/docs/manpage.html">cURL Man Page</a></li>
</ul>
<h2 id="solution">Solution<a class="headerlink" href="#solution" title="Permanent link">#</a></h2>
<p>Time to whip out those browser developer tools and pick some HTML locks. Kent gives you a bunch of hints covering developer tools for just about every mainstream browser out there so you should be good. Unless you're a <a href="https://xkcd.com/325/">Lynx user</a>. Anyway, we need to bypass 10 of these bad boys which honestly feels like a little overkill for a crate that 'only' contains a piece of paper with a villain's name written on it. What other secrets are you hiding in that crate, Shinny?</p>
<h3 id="lock-1">Lock 1<a class="headerlink" href="#lock-1" title="Permanent link">#</a></h3>
<p><strong>Riddle</strong>: <em>You don't need a clever riddle to open the console and scroll a little.</em></p>
<p>Starting off nice and slow. Open the developer tools, go to the JavaScript console and scroll up. Quick sidenote, the lock codes are dynamically generated and, except for 1 or 2 exceptions, will most likely not be the same as the ones you will find when solving this challenge. The final goal is accessing the crate though and not the codes themselves. </p>
<p><img alt="Lock 1" src="../../img/challenges/c11/c11_1.png" /></p>
<p><strong>Answer</strong>: <code>79183M9B</code></p>
<h3 id="lock-2">Lock 2<a class="headerlink" href="#lock-2" title="Permanent link">#</a></h3>
<p><strong>Riddle</strong>: <em>Some codes are hard to spy, perhaps they'll show up on pulp with dye?</em></p>
<p>The <code>strong</code> tags inside the <code>libra</code> class are hidden via <code>display: none</code> but the code is visible in the HTML.</p>
<p><img alt="Lock 2" src="../../img/challenges/c11/c11_2.png" /></p>
<p><strong>Answer</strong>: <code>UIZZC74T</code></p>
<h3 id="lock-3">Lock 3<a class="headerlink" href="#lock-3" title="Permanent link">#</a></h3>
<p><strong>Riddle</strong>: <em>This code is still unknown; it was fetched but never shown.</em></p>
<p>The code can be found in an image resource that was downloaded but not displayed on the page.</p>
<p><img alt="Lock 3" src="../../img/challenges/c11/c11_3.png" /></p>
<p><strong>Answer</strong>: <code>529P8GYF</code></p>
<h3 id="lock-4">Lock 4<a class="headerlink" href="#lock-4" title="Permanent link">#</a></h3>
<p><strong>Riddle</strong>: <em>Where might we keep the things we forage? Yes, of course: Local barrels!</em></p>
<p>The code's in the local storage section of the developer tools. </p>
<p><img alt="Lock 4" src="../../img/challenges/c11/c11_4.png" /></p>
<p><strong>Answer</strong>: <code>V6K7BU0L</code></p>
<h3 id="lock-5">Lock 5<a class="headerlink" href="#lock-5" title="Permanent link">#</a></h3>
<p><strong>Riddle</strong>: <em>Did you notice the code in the title? It may very well prove vital.</em></p>
<p>You'll find the code all the way to the right inside the <code>title</code> tags in the HTML header.</p>
<p><img alt="Lock 5" src="../../img/challenges/c11/c11_5.png" /></p>
<p><strong>Answer</strong>: <code>A6YICRGB</code></p>
<h3 id="lock-6">Lock 6<a class="headerlink" href="#lock-6" title="Permanent link">#</a></h3>
<p><strong>Riddle</strong>: <em>In order for this hologram to be effective, it may be necessary to increase your perspective.</em></p>
<p>Disable the <code>perspective</code> CSS property on the <code>hologram</code> class to reveal the code inside the hologram image.</p>
<p><img alt="Lock 6" src="../../img/challenges/c11/c11_6.png" /></p>
<p><strong>Answer</strong>: <code>EBQQ4A47</code></p>
<h3 id="lock-7">Lock 7<a class="headerlink" href="#lock-7" title="Permanent link">#</a></h3>
<p><strong>Riddle</strong>: <em>The font you're seeing is pretty slick, but this lock's code was my first pick.</em></p>
<p>Back to the <code>title</code> tags where the code is stored as a value of a <code>font-family</code> CSS property.</p>
<p><img alt="Lock 7" src="../../img/challenges/c11/c11_7.png" /></p>
<p><strong>Answer</strong>: <code>IC9WA4PC</code></p>
<h3 id="lock-8">Lock 8<a class="headerlink" href="#lock-8" title="Permanent link">#</a></h3>
<p><strong>Riddle</strong>: <em>In the event that the .eggs go bad, you must figure out who will be sad.</em></p>
<p>The <code>spoil</code> event listener on the <code>eggs</code> class leads to a JavaScript function with the code. </p>
<p><img alt="Lock 8" src="../../img/challenges/c11/c11_8.png" /></p>
<p><strong>Answer</strong>: <code>VERONICA</code></p>
<h3 id="lock-9">Lock 9<a class="headerlink" href="#lock-9" title="Permanent link">#</a></h3>
<p><strong>Riddle</strong>: <em>This next code will be unredacted, but only when all the chakras are :active.</em></p>
<p>Select each <code>chakra</code> class and set it to active to reveal the code in between the riddle text.</p>
<p><img alt="Lock 9" src="../../img/challenges/c11/c11_9.png" /></p>
<p><strong>Answer</strong>: <code>Y5EI2NGT</code></p>
<h3 id="lock-10">Lock 10<a class="headerlink" href="#lock-10" title="Permanent link">#</a></h3>
<p><strong>Riddle</strong>: <em>Oh, no! This lock's out of commission! Pop off the cover and locate what's missing.</em></p>
<p>Unlike the previous 9 locks this one requires a little more work to solve. Start by dragging the <code>cover</code> div outside of the lock to uncover, pun intended, the circuitry. Removing the <code>cover</code> class from the div works as well but the drag option results in a cooler visual. In the bottom right hand corner, vertically, and in small print you'll find <code>KD29XJ37</code>.</p>
<p><img alt="Lock 10 Inside" src="../../img/challenges/c11/c11_10.png" /></p>
<p>Try entering the code and be greeted with an error in the JavaScript console, stating 'Error: Missing Macaroni!'. The problem is there's three different components, <code>macaroni</code> being one of them, missing inside the lock div.</p>
<p><img alt="Obfuscated JavaScript" src="../../img/challenges/c11/c11_11.png" /></p>
<p>Taking the long route, deobfuscate the JavaScript code to better understand what exactly it's trying to check inside of that <code>try/catch</code> block. One option is to use the developer tools JavaScript console to evaluate small pieces of the code. For example, entering <code>_0x3170('0x56')</code> in the console will print "Missing macaroni!". Rinse and repeat until the code becomes more readable.</p>
<p><img alt="Deobfuscating JavaScript" src="../../img/challenges/c11/c11_12.png" /></p>
<pre><code class="javascript">try {
    const _0xc468b6 = document[&quot;querySelector&quot;](&quot;.locks &gt; li &gt; .lock.c10 &gt; .component.macaroni&quot;);
    if (!_0xc468b6)
        throw Error(&quot;Missing macaroni!&quot;);
    _0xc468b6[&quot;attributes&quot;][&quot;data-code&quot;][&quot;value&quot;];
    const _0x554445 = document[&quot;querySelector&quot;](&quot;.locks &gt; li &gt; .lock.c10 &gt; .component.swab&quot;);
    if (!_0x554445)
        throw Error(&quot;Missing cotton swab!&quot;);
    _0x554445[&quot;attributes&quot;][&quot;data-code&quot;][&quot;value&quot;];
    const _0xd33ab7 = document[&quot;querySelector&quot;](&quot;.locks &gt; li &gt; .lock.c10 &gt; .component.gnome&quot;);
    if (!_0xd33ab7)
        throw Error(&quot;Missing gnome!&quot;);
    _0xd33ab7[&quot;attributes&quot;][&quot;data-code&quot;][&quot;value&quot;];
    _0x39cbd(_0x47427d, {
        &quot;id&quot;: _0x47427d,
        &quot;code&quot;: _0x13fc35[&quot;value&quot;]
    });
} catch (_0x262527) {
    console[&quot;error&quot;](_0x262527);
}
</code></pre>

<p>It appears that the three components, defined as CSS classes, we're missing on this lock are <code>macaroni</code>, <code>swab</code>, and <code>gnome</code>. You will find 3 divs containing each of the required classes spread around the DOM. Fix things by dragging all of them inside of the lock div and you'll be able to open this final lock using the code <code>KD29XJ37</code>. Alternatively you can replace the <code>cover</code> class with <code>component macaroni swab gnome</code> and add a <code>data-code</code> parameter with a random value to the same div, but like before you'll miss out on some funny visuals.</p>
<p><img alt="Lock 10" src="../../img/challenges/c11/c11_13.png" /></p>
<p>Once all 10 locks have been opened the page displays Shinny Upatree's note. </p>
<p><img alt="Note" src="../../img/challenges/c11/c11_14.png" /></p>
<h2 id="answer">Answer<a class="headerlink" href="#answer" title="Permanent link">#</a></h2>
<p>Villain's name : <code>The Tooth Fairy</code></p>
<h2 id="hint">Hint<a class="headerlink" href="#hint" title="Permanent link">#</a></h2>
<blockquote>
<p>Wha - what?? You got into my crate?!<br />
Well that's embarrassing...<br />
But you know what? Hmm... If you're good enough to crack MY security...<br />
Do you think you could bring this all to a grand conclusion?<br />
Please go into the sleigh shop and see if you can finish this off!<br />
Stop the Tooth Fairy from ruining Santa's sleigh route!</p>
</blockquote></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Thomas Bouve - <a href="https://twitter.com/crahan">@CraHan</a></p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
